{"ast":null,"code":"import{usersAPI}from\"../../API/api\";import{updateObjinArr}from\"../../utilits/objHelper\";const FOLLOW=\"FOLLOW\";const UNFOLLOW=\"UNFOLLOW\";const SET_USERS='\"SET_USERS';const SET_CURRENT_PAGE=\"SET_CURRENT_PAGE\";const SET_TOTAL_COUNT=\"SET_TOTAL_COUNT\";const TOGGLE_IS_FETCHING=\"TOGGLE_IS_FETCHING\";const TOGGLE_IS_FOLLOWING_PROGRESS=\"TOGGLE_IS_FOLLOWING_PROGRESS\";let initialState={users:[],pageSize:10,totalItemsCount:0,currentPage:1,isFetching:false,followingInProgress:[]};const usersReducer=function(){let state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;let action=arguments.length>1?arguments[1]:undefined;switch(action.type){case FOLLOW:return{...state,users:updateObjinArr(state.users,action.userId,\"id\",{followed:true})};case UNFOLLOW:return{...state,users:updateObjinArr(state.users,action.userId,\"id\",{followed:false})};case SET_USERS:return{...state,users:action.users};case SET_CURRENT_PAGE:return{...state,currentPage:action.currentPage};case SET_TOTAL_COUNT:return{...state,totalUsersCount:action.count};case TOGGLE_IS_FETCHING:return{...state,isFetching:action.isFetching};case TOGGLE_IS_FOLLOWING_PROGRESS:return{...state,followingInProgress:action.isFetching?[...state.followingInProgress,action.userId]:state.followingInProgress.filter(id=>id!==action.userId)};default:return state;}};export const followSuccess=userId=>({type:FOLLOW,userId});export const unfollowSuccess=userId=>({type:UNFOLLOW,userId});export const setUsers=users=>({type:SET_USERS,users});export const setCurrentPage=currentPage=>({type:SET_CURRENT_PAGE,currentPage});export const setTotalUsersCount=totalUsersCount=>({type:SET_TOTAL_COUNT,count:totalUsersCount});export const toggleIsFetching=isFetching=>({type:TOGGLE_IS_FETCHING,isFetching});export const toggleFollowingProgress=(isFetching,userId)=>({type:TOGGLE_IS_FOLLOWING_PROGRESS,isFetching,userId});export const getUsers=(currentPage,pageSize)=>{return async dispatch=>{dispatch(toggleIsFetching(true));dispatch(setCurrentPage(currentPage));let data=await usersAPI.getUsers(currentPage,pageSize);dispatch(toggleIsFetching(false));dispatch(setUsers(data.items));dispatch(setTotalUsersCount(data.totalCount));};};const followFlow=async(dispatch,userId,apiMethod,actionCreator)=>{dispatch(toggleFollowingProgress(true,userId));let response=await apiMethod(userId);if(response.data.resultCode===0){dispatch(actionCreator(userId));}dispatch(toggleFollowingProgress(false,userId));};export const follow=userId=>{return async dispatch=>{followFlow(dispatch,userId,usersAPI.follow.bind(usersAPI),followSuccess);};};export const unfollow=userId=>{return async dispatch=>{followFlow(dispatch,userId,usersAPI.unfollow.bind(usersAPI),unfollowSuccess);};};export default usersReducer;","map":{"version":3,"names":["usersAPI","updateObjinArr","FOLLOW","UNFOLLOW","SET_USERS","SET_CURRENT_PAGE","SET_TOTAL_COUNT","TOGGLE_IS_FETCHING","TOGGLE_IS_FOLLOWING_PROGRESS","initialState","users","pageSize","totalItemsCount","currentPage","isFetching","followingInProgress","usersReducer","state","arguments","length","undefined","action","type","userId","followed","totalUsersCount","count","filter","id","followSuccess","unfollowSuccess","setUsers","setCurrentPage","setTotalUsersCount","toggleIsFetching","toggleFollowingProgress","getUsers","dispatch","data","items","totalCount","followFlow","apiMethod","actionCreator","response","resultCode","follow","bind","unfollow"],"sources":["/Users/oskvernitel/lernJS/react/legendary-site/src/components/Redux/usersReducer.js"],"sourcesContent":["import { usersAPI } from \"../../API/api\";\nimport { updateObjinArr } from \"../../utilits/objHelper\";\n\nconst FOLLOW = \"FOLLOW\";\nconst UNFOLLOW = \"UNFOLLOW\";\nconst SET_USERS = '\"SET_USERS';\nconst SET_CURRENT_PAGE = \"SET_CURRENT_PAGE\";\nconst SET_TOTAL_COUNT = \"SET_TOTAL_COUNT\";\nconst TOGGLE_IS_FETCHING = \"TOGGLE_IS_FETCHING\";\nconst TOGGLE_IS_FOLLOWING_PROGRESS = \"TOGGLE_IS_FOLLOWING_PROGRESS\";\n\nlet initialState = {\n  users: [],\n  pageSize: 10,\n  totalItemsCount: 0,\n  currentPage: 1,\n  isFetching: false,\n  followingInProgress: [],\n};\n\nconst usersReducer = (state = initialState, action) => {\n  switch (action.type) {\n    case FOLLOW:\n      return {\n        ...state,\n        users: updateObjinArr(state.users,action.userId, \"id\", {followed: true})\n      };\n    case UNFOLLOW:\n      return {\n        ...state,\n        users: updateObjinArr(state.users,action.userId, \"id\", {followed: false})\n      };\n    case SET_USERS:\n      return { ...state, users: action.users };\n    case SET_CURRENT_PAGE:\n      return { ...state, currentPage: action.currentPage };\n    case SET_TOTAL_COUNT:\n      return { ...state, totalUsersCount: action.count };\n    case TOGGLE_IS_FETCHING:\n      return { ...state, isFetching: action.isFetching };\n    case TOGGLE_IS_FOLLOWING_PROGRESS:\n      return {\n        ...state,\n        followingInProgress: action.isFetching\n          ? [...state.followingInProgress, action.userId]\n          : state.followingInProgress.filter((id) => id !== action.userId),\n      };\n    default:\n      return state;\n  }\n};\n\nexport const followSuccess = (userId) => ({ type: FOLLOW, userId });\nexport const unfollowSuccess = (userId) => ({ type: UNFOLLOW, userId });\nexport const setUsers = (users) => ({ type: SET_USERS, users });\nexport const setCurrentPage = (currentPage) => ({type: SET_CURRENT_PAGE, currentPage});\nexport const setTotalUsersCount = (totalUsersCount) => ({\n  type: SET_TOTAL_COUNT,\n  count: totalUsersCount,\n});\nexport const toggleIsFetching = (isFetching) => ({\n  type: TOGGLE_IS_FETCHING,\n  isFetching,\n});\nexport const toggleFollowingProgress = (isFetching, userId) => ({\n  type: TOGGLE_IS_FOLLOWING_PROGRESS,\n  isFetching,\n  userId,\n});\n\nexport const getUsers = (currentPage, pageSize) => {\n  return async (dispatch) => {\n    dispatch(toggleIsFetching(true));\n    dispatch(setCurrentPage(currentPage));\n    let data = await usersAPI.getUsers(currentPage, pageSize);\n    dispatch(toggleIsFetching(false));\n    dispatch(setUsers(data.items));\n    dispatch(setTotalUsersCount(data.totalCount));\n  };\n};\n\nconst followFlow = async(dispatch, userId, apiMethod, actionCreator) => {\n  dispatch(toggleFollowingProgress(true, userId));\n  let response = await apiMethod(userId);\n  if (response.data.resultCode === 0) {\n    dispatch(actionCreator(userId));\n  }\n  dispatch(toggleFollowingProgress(false, userId));\n};\n\nexport const follow = (userId) => {\n  return async (dispatch) => {\n    followFlow(dispatch, userId, usersAPI.follow.bind(usersAPI), followSuccess)\n}};\n\nexport const unfollow = (userId) => {\n  return async (dispatch) => {\n    followFlow(dispatch, userId, usersAPI.unfollow.bind(usersAPI), unfollowSuccess)\n  };\n};\n\nexport default usersReducer;\n"],"mappings":"AAAA,OAASA,QAAQ,KAAQ,eAAe,CACxC,OAASC,cAAc,KAAQ,yBAAyB,CAExD,KAAM,CAAAC,MAAM,CAAG,QAAQ,CACvB,KAAM,CAAAC,QAAQ,CAAG,UAAU,CAC3B,KAAM,CAAAC,SAAS,CAAG,YAAY,CAC9B,KAAM,CAAAC,gBAAgB,CAAG,kBAAkB,CAC3C,KAAM,CAAAC,eAAe,CAAG,iBAAiB,CACzC,KAAM,CAAAC,kBAAkB,CAAG,oBAAoB,CAC/C,KAAM,CAAAC,4BAA4B,CAAG,8BAA8B,CAEnE,GAAI,CAAAC,YAAY,CAAG,CACjBC,KAAK,CAAE,EAAE,CACTC,QAAQ,CAAE,EAAE,CACZC,eAAe,CAAE,CAAC,CAClBC,WAAW,CAAE,CAAC,CACdC,UAAU,CAAE,KAAK,CACjBC,mBAAmB,CAAE,EACvB,CAAC,CAED,KAAM,CAAAC,YAAY,CAAG,QAAAA,CAAA,CAAkC,IAAjC,CAAAC,KAAK,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAGT,YAAY,IAAE,CAAAY,MAAM,CAAAH,SAAA,CAAAC,MAAA,GAAAD,SAAA,IAAAE,SAAA,CAChD,OAAQC,MAAM,CAACC,IAAI,EACjB,IAAK,CAAApB,MAAM,CACT,MAAO,CACL,GAAGe,KAAK,CACRP,KAAK,CAAET,cAAc,CAACgB,KAAK,CAACP,KAAK,CAACW,MAAM,CAACE,MAAM,CAAE,IAAI,CAAE,CAACC,QAAQ,CAAE,IAAI,CAAC,CACzE,CAAC,CACH,IAAK,CAAArB,QAAQ,CACX,MAAO,CACL,GAAGc,KAAK,CACRP,KAAK,CAAET,cAAc,CAACgB,KAAK,CAACP,KAAK,CAACW,MAAM,CAACE,MAAM,CAAE,IAAI,CAAE,CAACC,QAAQ,CAAE,KAAK,CAAC,CAC1E,CAAC,CACH,IAAK,CAAApB,SAAS,CACZ,MAAO,CAAE,GAAGa,KAAK,CAAEP,KAAK,CAAEW,MAAM,CAACX,KAAM,CAAC,CAC1C,IAAK,CAAAL,gBAAgB,CACnB,MAAO,CAAE,GAAGY,KAAK,CAAEJ,WAAW,CAAEQ,MAAM,CAACR,WAAY,CAAC,CACtD,IAAK,CAAAP,eAAe,CAClB,MAAO,CAAE,GAAGW,KAAK,CAAEQ,eAAe,CAAEJ,MAAM,CAACK,KAAM,CAAC,CACpD,IAAK,CAAAnB,kBAAkB,CACrB,MAAO,CAAE,GAAGU,KAAK,CAAEH,UAAU,CAAEO,MAAM,CAACP,UAAW,CAAC,CACpD,IAAK,CAAAN,4BAA4B,CAC/B,MAAO,CACL,GAAGS,KAAK,CACRF,mBAAmB,CAAEM,MAAM,CAACP,UAAU,CAClC,CAAC,GAAGG,KAAK,CAACF,mBAAmB,CAAEM,MAAM,CAACE,MAAM,CAAC,CAC7CN,KAAK,CAACF,mBAAmB,CAACY,MAAM,CAAEC,EAAE,EAAKA,EAAE,GAAKP,MAAM,CAACE,MAAM,CACnE,CAAC,CACH,QACE,MAAO,CAAAN,KAAK,CAChB,CACF,CAAC,CAED,MAAO,MAAM,CAAAY,aAAa,CAAIN,MAAM,GAAM,CAAED,IAAI,CAAEpB,MAAM,CAAEqB,MAAO,CAAC,CAAC,CACnE,MAAO,MAAM,CAAAO,eAAe,CAAIP,MAAM,GAAM,CAAED,IAAI,CAAEnB,QAAQ,CAAEoB,MAAO,CAAC,CAAC,CACvE,MAAO,MAAM,CAAAQ,QAAQ,CAAIrB,KAAK,GAAM,CAAEY,IAAI,CAAElB,SAAS,CAAEM,KAAM,CAAC,CAAC,CAC/D,MAAO,MAAM,CAAAsB,cAAc,CAAInB,WAAW,GAAM,CAACS,IAAI,CAAEjB,gBAAgB,CAAEQ,WAAW,CAAC,CAAC,CACtF,MAAO,MAAM,CAAAoB,kBAAkB,CAAIR,eAAe,GAAM,CACtDH,IAAI,CAAEhB,eAAe,CACrBoB,KAAK,CAAED,eACT,CAAC,CAAC,CACF,MAAO,MAAM,CAAAS,gBAAgB,CAAIpB,UAAU,GAAM,CAC/CQ,IAAI,CAAEf,kBAAkB,CACxBO,UACF,CAAC,CAAC,CACF,MAAO,MAAM,CAAAqB,uBAAuB,CAAGA,CAACrB,UAAU,CAAES,MAAM,IAAM,CAC9DD,IAAI,CAAEd,4BAA4B,CAClCM,UAAU,CACVS,MACF,CAAC,CAAC,CAEF,MAAO,MAAM,CAAAa,QAAQ,CAAGA,CAACvB,WAAW,CAAEF,QAAQ,GAAK,CACjD,MAAO,MAAO,CAAA0B,QAAQ,EAAK,CACzBA,QAAQ,CAACH,gBAAgB,CAAC,IAAI,CAAC,CAAC,CAChCG,QAAQ,CAACL,cAAc,CAACnB,WAAW,CAAC,CAAC,CACrC,GAAI,CAAAyB,IAAI,CAAG,KAAM,CAAAtC,QAAQ,CAACoC,QAAQ,CAACvB,WAAW,CAAEF,QAAQ,CAAC,CACzD0B,QAAQ,CAACH,gBAAgB,CAAC,KAAK,CAAC,CAAC,CACjCG,QAAQ,CAACN,QAAQ,CAACO,IAAI,CAACC,KAAK,CAAC,CAAC,CAC9BF,QAAQ,CAACJ,kBAAkB,CAACK,IAAI,CAACE,UAAU,CAAC,CAAC,CAC/C,CAAC,CACH,CAAC,CAED,KAAM,CAAAC,UAAU,CAAG,KAAAA,CAAMJ,QAAQ,CAAEd,MAAM,CAAEmB,SAAS,CAAEC,aAAa,GAAK,CACtEN,QAAQ,CAACF,uBAAuB,CAAC,IAAI,CAAEZ,MAAM,CAAC,CAAC,CAC/C,GAAI,CAAAqB,QAAQ,CAAG,KAAM,CAAAF,SAAS,CAACnB,MAAM,CAAC,CACtC,GAAIqB,QAAQ,CAACN,IAAI,CAACO,UAAU,GAAK,CAAC,CAAE,CAClCR,QAAQ,CAACM,aAAa,CAACpB,MAAM,CAAC,CAAC,CACjC,CACAc,QAAQ,CAACF,uBAAuB,CAAC,KAAK,CAAEZ,MAAM,CAAC,CAAC,CAClD,CAAC,CAED,MAAO,MAAM,CAAAuB,MAAM,CAAIvB,MAAM,EAAK,CAChC,MAAO,MAAO,CAAAc,QAAQ,EAAK,CACzBI,UAAU,CAACJ,QAAQ,CAAEd,MAAM,CAAEvB,QAAQ,CAAC8C,MAAM,CAACC,IAAI,CAAC/C,QAAQ,CAAC,CAAE6B,aAAa,CAAC,CAC/E,CAAC,EAAC,CAEF,MAAO,MAAM,CAAAmB,QAAQ,CAAIzB,MAAM,EAAK,CAClC,MAAO,MAAO,CAAAc,QAAQ,EAAK,CACzBI,UAAU,CAACJ,QAAQ,CAAEd,MAAM,CAAEvB,QAAQ,CAACgD,QAAQ,CAACD,IAAI,CAAC/C,QAAQ,CAAC,CAAE8B,eAAe,CAAC,CACjF,CAAC,CACH,CAAC,CAED,cAAe,CAAAd,YAAY"},"metadata":{},"sourceType":"module","externalDependencies":[]}