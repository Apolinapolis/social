{"ast":null,"code":"import{stopSubmit}from\"redux-form\";import{authAPI}from\"../../API/api\";const SET_USER_DATA=\"SET_USER_DATA\";let initialState={usersId:null,email:null,login:null,isAuth:false};const authReducer=function(){let state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;let action=arguments.length>1?arguments[1]:undefined;switch(action.type){case SET_USER_DATA:return{...state,...action.payload};default:return state;}};export const setUserData=(userId,email,login,isAuth)=>({type:SET_USER_DATA,payload:{userId,email,login,isAuth}});export const getAuthUserData=()=>async dispatch=>{const response=await authAPI.me();if(response.data.resultCode===0){let{id,email,login}=response.data.data;dispatch(setUserData(id,email,login,true));}};export const login=(email,password,rememberMe)=>async dispatch=>{let response=await authAPI.login(email,password,rememberMe);if(response.data.resultCode===0){dispatch(getAuthUserData());}else{let message=response.data.messages.length>0?response.data.messages[0]:\"Some error\";dispatch(stopSubmit(\"login\",{_error:message}));}};export const logout=()=>async dispatch=>{let response=await authAPI.logout();if(response.data.resultCode===0){dispatch(setUserData(null,null,null,false));}};export default authReducer;","map":{"version":3,"names":["stopSubmit","authAPI","SET_USER_DATA","initialState","usersId","email","login","isAuth","authReducer","state","arguments","length","undefined","action","type","payload","setUserData","userId","getAuthUserData","dispatch","response","me","data","resultCode","id","password","rememberMe","message","messages","_error","logout"],"sources":["/Users/oskvernitel/lernJS/react/legendary-site/src/components/Redux/authReducer.js"],"sourcesContent":["import { stopSubmit } from \"redux-form\";\nimport { authAPI } from \"../../API/api\";\n\nconst SET_USER_DATA = \"SET_USER_DATA\"\n\nlet initialState = {\n  usersId: null,\n  email: null,\n  login: null,\n  isAuth: false,\n};\n\nconst authReducer = (state = initialState, action) => {\n  switch (action.type) {\n    case SET_USER_DATA:\n      return {...state,...action.payload}\n    default: return state\n}}\n\nexport const setUserData = (userId, email, login, isAuth ) => ({type: SET_USER_DATA, payload: {userId, email,login, isAuth} })\n\nexport const getAuthUserData = () => async (dispatch) => {\n    const response = await authAPI.me();\n  if (response.data.resultCode === 0) {\n    let { id, email, login } = response.data.data;\n    dispatch(setUserData(id, email, login, true));\n  }\n}\n\nexport const login = (email, password, rememberMe) => async (dispatch) => {\n  let response = await authAPI.login(email, password, rememberMe);\n  if (response.data.resultCode === 0) {\n    dispatch(getAuthUserData());\n  } else {\n    let message =\n      response.data.messages.length > 0\n        ? response.data.messages[0]\n        : \"Some error\";\n    dispatch(stopSubmit(\"login\", { _error: message }));\n  }\n};\n\nexport const logout = () => async (dispatch) => {\n  let response = await authAPI.logout();\n  if (response.data.resultCode === 0) {\n    dispatch(setUserData(null, null, null, false));\n  }\n};\nexport default authReducer;"],"mappings":"AAAA,OAASA,UAAU,KAAQ,YAAY,CACvC,OAASC,OAAO,KAAQ,eAAe,CAEvC,KAAM,CAAAC,aAAa,CAAG,eAAe,CAErC,GAAI,CAAAC,YAAY,CAAG,CACjBC,OAAO,CAAE,IAAI,CACbC,KAAK,CAAE,IAAI,CACXC,KAAK,CAAE,IAAI,CACXC,MAAM,CAAE,KACV,CAAC,CAED,KAAM,CAAAC,WAAW,CAAG,QAAAA,CAAA,CAAkC,IAAjC,CAAAC,KAAK,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAGP,YAAY,IAAE,CAAAU,MAAM,CAAAH,SAAA,CAAAC,MAAA,GAAAD,SAAA,IAAAE,SAAA,CAC/C,OAAQC,MAAM,CAACC,IAAI,EACjB,IAAK,CAAAZ,aAAa,CAChB,MAAO,CAAC,GAAGO,KAAK,CAAC,GAAGI,MAAM,CAACE,OAAO,CAAC,CACrC,QAAS,MAAO,CAAAN,KAAK,CACzB,CAAC,CAAC,CAEF,MAAO,MAAM,CAAAO,WAAW,CAAGA,CAACC,MAAM,CAAEZ,KAAK,CAAEC,KAAK,CAAEC,MAAM,IAAO,CAACO,IAAI,CAAEZ,aAAa,CAAEa,OAAO,CAAE,CAACE,MAAM,CAAEZ,KAAK,CAACC,KAAK,CAAEC,MAAM,CAAE,CAAC,CAAC,CAE9H,MAAO,MAAM,CAAAW,eAAe,CAAGA,CAAA,GAAM,KAAO,CAAAC,QAAQ,EAAK,CACrD,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAnB,OAAO,CAACoB,EAAE,CAAC,CAAC,CACrC,GAAID,QAAQ,CAACE,IAAI,CAACC,UAAU,GAAK,CAAC,CAAE,CAClC,GAAI,CAAEC,EAAE,CAAEnB,KAAK,CAAEC,KAAM,CAAC,CAAGc,QAAQ,CAACE,IAAI,CAACA,IAAI,CAC7CH,QAAQ,CAACH,WAAW,CAACQ,EAAE,CAAEnB,KAAK,CAAEC,KAAK,CAAE,IAAI,CAAC,CAAC,CAC/C,CACF,CAAC,CAED,MAAO,MAAM,CAAAA,KAAK,CAAGA,CAACD,KAAK,CAAEoB,QAAQ,CAAEC,UAAU,GAAK,KAAO,CAAAP,QAAQ,EAAK,CACxE,GAAI,CAAAC,QAAQ,CAAG,KAAM,CAAAnB,OAAO,CAACK,KAAK,CAACD,KAAK,CAAEoB,QAAQ,CAAEC,UAAU,CAAC,CAC/D,GAAIN,QAAQ,CAACE,IAAI,CAACC,UAAU,GAAK,CAAC,CAAE,CAClCJ,QAAQ,CAACD,eAAe,CAAC,CAAC,CAAC,CAC7B,CAAC,IAAM,CACL,GAAI,CAAAS,OAAO,CACTP,QAAQ,CAACE,IAAI,CAACM,QAAQ,CAACjB,MAAM,CAAG,CAAC,CAC7BS,QAAQ,CAACE,IAAI,CAACM,QAAQ,CAAC,CAAC,CAAC,CACzB,YAAY,CAClBT,QAAQ,CAACnB,UAAU,CAAC,OAAO,CAAE,CAAE6B,MAAM,CAAEF,OAAQ,CAAC,CAAC,CAAC,CACpD,CACF,CAAC,CAED,MAAO,MAAM,CAAAG,MAAM,CAAGA,CAAA,GAAM,KAAO,CAAAX,QAAQ,EAAK,CAC9C,GAAI,CAAAC,QAAQ,CAAG,KAAM,CAAAnB,OAAO,CAAC6B,MAAM,CAAC,CAAC,CACrC,GAAIV,QAAQ,CAACE,IAAI,CAACC,UAAU,GAAK,CAAC,CAAE,CAClCJ,QAAQ,CAACH,WAAW,CAAC,IAAI,CAAE,IAAI,CAAE,IAAI,CAAE,KAAK,CAAC,CAAC,CAChD,CACF,CAAC,CACD,cAAe,CAAAR,WAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}