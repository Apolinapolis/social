{"ast":null,"code":"import{Navigate}from\"react-router-dom\";import{usersAPI,profileAPI}from\"../../API/api\";import{stopSubmit}from\"redux-form\";import{jsx as _jsx}from\"react/jsx-runtime\";const ADD_POST=\"ADD-POST\";const SET_USER_PROFILE=\"SET_USER_PROFILE\";const SET_STATUS=\"SET_STATUS\";const DEL_POST=\"DEL_POST\";const SAVE_PHOTO=\"SAVE_PHOTO\";let initialState={posts:[{id:1,likesCount:12,message:\"Hello, BRO\"},{id:2,likesCount:4,message:\"Hello, B\"},{id:3,likesCount:51,message:\"Hell Oy\"},{id:4,likesCount:614,message:\"airuqp ppq uqweh b\"},{id:5,likesCount:111,message:\"It`s my first post!\"}],profile:null,status:\"it is status in profileReduser\"};const profileReducer=function(){let state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;let action=arguments.length>1?arguments[1]:undefined;switch(action.type){case ADD_POST:let newPost={id:5,message:action.myPostText,likesCount:0};return{...state,posts:[...state.posts,newPost],newPostText:\"\"};case SET_USER_PROFILE:return{...state,profile:action.profile};case SET_STATUS:return{...state,status:action.status};case DEL_POST:return{...state,posts:state.posts.filter(p=>p.id!==action.postId)};case SAVE_PHOTO:return{...state,profile:{...state.profile,protos:action.photos}};default:return state;}};export const addPostActionCreator=myPostText=>({type:ADD_POST,myPostText});export const setUserProfile=profile=>({type:SET_USER_PROFILE,profile});export const setStatus=status=>({type:SET_STATUS,status});export const deletePost=postId=>({type:DEL_POST,postId});export const savePhotoSuccess=photos=>({type:SAVE_PHOTO,photos});export const getUserProfile=userId=>async dispatch=>{if(!userId)return/*#__PURE__*/_jsx(Navigate,{to:\"/login\"});let response=await usersAPI.getProfile(userId);// thunk userId - undefind WHY\ndispatch(setUserProfile(response.data));};export const getStatus=userId=>async dispatch=>{if(!userId)return/*#__PURE__*/_jsx(Navigate,{to:\"/login\"});let response=await profileAPI.getStatus(userId);dispatch(setStatus(response.data));};export const updateStatus=status=>async dispatch=>{try{let response=await profileAPI.updateStatus(status);if(response.data.resultCode===0){dispatch(setStatus(status));}}catch(error){console.error(\"Some error\");}};export const savePhoto=file=>async dispatch=>{let response=await profileAPI.savePhoto(file);if(response.data.resultCode===0){dispatch(savePhotoSuccess(response.data.data.photos));}};export const saveProfile=profile=>async(dispatch,getState)=>{const userId=getState().auth.userId;const response=await profileAPI.saveProfile(profile);if(response.data.resultCode===0){dispatch(getUserProfile(userId));}else{dispatch(stopSubmit(\"edit-profile\",{_error:response.data.messages[0]}));return Promise.reject(response.data.messages[0]);}};export default profileReducer;","map":{"version":3,"names":["Navigate","usersAPI","profileAPI","stopSubmit","jsx","_jsx","ADD_POST","SET_USER_PROFILE","SET_STATUS","DEL_POST","SAVE_PHOTO","initialState","posts","id","likesCount","message","profile","status","profileReducer","state","arguments","length","undefined","action","type","newPost","myPostText","newPostText","filter","p","postId","protos","photos","addPostActionCreator","setUserProfile","setStatus","deletePost","savePhotoSuccess","getUserProfile","userId","dispatch","to","response","getProfile","data","getStatus","updateStatus","resultCode","error","console","savePhoto","file","saveProfile","getState","auth","_error","messages","Promise","reject"],"sources":["/Users/oskvernitel/lernJS/react/legendary-site/src/components/Redux/profileReducer.js"],"sourcesContent":["import { Navigate } from \"react-router-dom\";\nimport { usersAPI, profileAPI } from \"../../API/api\";\nimport { stopSubmit } from \"redux-form\";\n\n\nconst ADD_POST = \"ADD-POST\";\nconst SET_USER_PROFILE = \"SET_USER_PROFILE\"\nconst SET_STATUS = \"SET_STATUS\"\nconst DEL_POST = \"DEL_POST\"\nconst SAVE_PHOTO = \"SAVE_PHOTO\"\n\nlet initialState = {\n  posts: [\n    { id: 1, likesCount: 12, message: \"Hello, BRO\" },\n    { id: 2, likesCount: 4, message: \"Hello, B\" },\n    { id: 3, likesCount: 51, message: \"Hell Oy\" },\n    { id: 4, likesCount: 614, message: \"airuqp ppq uqweh b\" },\n    { id: 5, likesCount: 111, message: \"It`s my first post!\" }],\n    profile: null,\n    status: \"it is status in profileReduser\",\n};\n\nconst profileReducer = (state = initialState, action) => {\n  switch (action.type) {\n    case ADD_POST:\n      let newPost = {\n        id: 5,\n        message: action.myPostText,\n        likesCount: 0,\n      };\n      return { ...state, posts: [...state.posts, newPost], newPostText: \"\" };\n    case SET_USER_PROFILE:\n      return { ...state, profile: action.profile };\n    case SET_STATUS:\n      return { ...state, status: action.status };\n    case DEL_POST:\n      return { ...state, posts: state.posts.filter(p => p.id !== action.postId) };\n    case SAVE_PHOTO:\n      return { ...state, profile: {...state.profile, protos: action.photos} };\n    default:\n      return state;\n  }\n};\n\nexport const addPostActionCreator = (myPostText) => ({ type: ADD_POST, myPostText });\nexport const setUserProfile = (profile) => ({ type: SET_USER_PROFILE, profile});\nexport const setStatus = (status) => ({ type: SET_STATUS, status});\nexport const deletePost = (postId) => ({ type: DEL_POST, postId});\nexport const savePhotoSuccess = (photos) => ({ type: SAVE_PHOTO, photos});\n\nexport const getUserProfile = (userId) => async (dispatch) => {\n  if (!userId)  return <Navigate to={\"/login\"}/>\n  let response = await usersAPI.getProfile(userId) // thunk userId - undefind WHY\n  dispatch(setUserProfile(response.data))\n  };\n\nexport const getStatus = (userId) => async (dispatch) => {\n  if (!userId)  return <Navigate to={\"/login\"}/>\n  let response = await profileAPI.getStatus(userId);\n  dispatch(setStatus(response.data))\n  }\n\nexport const updateStatus = (status) => async (dispatch) => { \n  try {\n  let response = await profileAPI.updateStatus(status)\n  if (response.data.resultCode === 0){ dispatch(setStatus(status)) }\n} catch(error) {console.error(\"Some error\")}}\n\n export const savePhoto = (file) => async (dispatch) => {\n    let response = await profileAPI.savePhoto(file)\n    if (response.data.resultCode === 0) {dispatch(savePhotoSuccess(response.data.data.photos))}\n  }\n export const saveProfile = (profile) => async (dispatch, getState) => {\n  const userId = getState().auth.userId\n  const response = await profileAPI.saveProfile(profile)\n    if (response.data.resultCode === 0) {dispatch(getUserProfile(userId))}\n    else {dispatch(stopSubmit(\"edit-profile\", { _error: response.data.messages[0] }))\n    return Promise.reject(response.data.messages[0])\n  }}\n\nexport default profileReducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}